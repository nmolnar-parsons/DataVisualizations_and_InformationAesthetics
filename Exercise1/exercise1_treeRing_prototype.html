<!DOCTYPE html>
<html>
<head>
    <title>Exercise 1 Prototype NMolnar</title>
    <script src="https://d3js.org/d3.v7.min.js"></script> 
    <!-- Used GPT-4.1 ask mode for d3 styling and proper formatting of attributes-->
    
    <style> 
    /*
        Differently styled elements:
        tree-ring container (needs styling around placement of items inside svg)
        circles (need color, but this should alternate. Size is determined by data)
            color should be determined by index of data, if odd one color if even another
    */
        .tree-ring-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        
    </style>

</head>
    <body>
        <div>  
            <svg id="tree_ring_container"></svg>
            <svg id="tree_ring_container2"></svg>
        </div>

        <script>
            //create dummy data
            const years = [1991,1992,1993,1994,1995,1996,1997,1998,1999,2000] // years from 2000 to 2023
            const values = [5,7,9,10,22,5,8,10,4,13] // dummy data for now
            const data = {};
            for (var i = 0; i < years.length; i++) {
                var currentYear = years[i];
                var currentValues = values[i];
                data[currentYear] = {};
                data[currentYear] = values[i];
            };


            // set up basic variables
            // width and height of svg based on window
            // radius of largest circle if building down? or a max radius?
            //center x and y of svg

            const svg = d3.select("#tree_ring_container");
            const svg2 = d3.select("#tree_ring_container2")
            const width = window.innerWidth/2;
            const height = window.innerHeight/2;
            const centerX = width / 2;
            const centerY = height / 2;            


            svg.attr("width", width).attr("height", height);
            svg2.attr("width", width).attr("height", height);

            var maxradius = (Math.max(width,height)/2 - 20)/2; // max radius of largest circle
            var sum = values.reduce((a, b) => a + b, 0); //sum of all values
            var scale = d3.scaleLinear() //curently not used
                .domain([0, sum])
                .range([0, maxradius]);
       

            


            for (let i = years.length - 1; i >= 0; i--) { // loop backwards through years to draw largest first
                const circle = svg.append("circle")
                    .attr("cx", centerX)
                    .attr("cy", centerY)
                    .attr("r", (values[i] * (maxradius/23))) // radius based on index of year
                    .attr("fill", i % 2 === 0 ? "#ed1f52" : "#1f56ed") // alternating colors
                    .attr("opacity", 0.6)
                    .attr("stroke", "black")
                    .attr("stroke-width", 1);  
                    console.log("circle added")
                
                    svg.append("text")
                    .attr("x", centerX)
                    .attr("y", centerY - (values[i] * (maxradius / 23)) + 15) // position text at top of circle
                    .attr("text-anchor", "middle")
                    .attr("font-family", "Arial, sans-serif")
                    .attr("font-size", "12px")
                    .attr("fill", "black")
                    .text(years[i]);
            };


            //alternate approach
            //problem is that this is not based on the max radius, so circles can get too big for the svg

            // for this solution, vscode copilot GPT-4.1 ask mode helped. 
            let currentRadius = 0;
            for (let i = 0; i < values.length; i++) {
                currentRadius += values[i]; // move to the center of the ring
                svg2.append("circle")
                    .attr("cx", centerX)
                    .attr("cy", centerY)
                    .attr("r", currentRadius)
                    .attr("fill", "none")
                    .attr("stroke", i % 2 === 0 ? "#ed1f52" : "#1f56ed")
                    .attr("stroke-width", values[i]*2)
                    .attr("opacity", 0.6);

                // could append border/spacer circle here
                svg2.append("circle")
                    .attr("cx", centerX)
                    .attr("cy", centerY)
                    .attr("r", currentRadius + (values[i])) // spacer circle
                    .attr("fill", "none")
                    .attr("stroke", "black")
                    .attr("stroke-width", 2)
                    .attr("opacity", 1);
                svg2.append("text")
                    .attr("x", centerX)
                    .attr("y", centerY - currentRadius + (values[i] / 2)) // position text at top of circle
                    .attr("text-anchor", "middle")
                    .attr("font-family", "Arial, sans-serif")
                    .attr("font-size", "12px")
                    .attr("fill", "black")
                    .text(years[i]);
                currentRadius += values[i]; // move to the edge of the ring for next
            }

            // currently this hides smaller circles behind bigger ones.
            // also want to change this so I'm using .data in d3 as opposed to a for loop?
            //rework to us d3 scales?

            // could change this to arcs 

            // could do arcs with percentage filled? like a wrapped streamgraph or progress bar?

        </script>


    </body>
</html>